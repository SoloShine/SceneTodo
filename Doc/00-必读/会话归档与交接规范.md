# ?? 会话归档与交接规范

> **创建日期**: 2025-01-02  
> **版本**: 1.0  
> **状态**: 正式发布  
> **适用范围**: 所有会话的归档和交接工作

---

## ?? 文档说明

本规范定义了会话完成后的归档流程和下一会话的交接准备工作，确保项目文档体系的完整性、一致性和可维护性。

**重要性**: ?????  
**必须遵守**: 是  
**执行时机**: 每个会话完成后

---

## ?? 核心原则

### 1. 完整性原则
- ? 所有会话文档必须完整归档
- ? 规划文档必须归档到会话记录
- ? 交接文档必须包含完整信息
- ? 不能遗漏任何重要文档

### 2. 及时性原则
- ? 会话完成后立即归档
- ? 交接文档应在归档时创建
- ? 不拖延到下一会话
- ? 保持文档时效性

### 3. 清晰性原则
- ? 目录结构清晰明确
- ? 文档分类合理
- ? 命名规范统一
- ? 易于查找和理解

### 4. 简洁性原则
- ? 规划目录只保留当前
- ? 历史规划归档到会话记录
- ? 避免文档重复
- ? 保持目录简洁

---

## ?? 目录结构规范

### 规划文档目录（06-规划文档）

**保留内容**：
```
Doc/06-规划文档/
├── README-规划文档说明.md              [必须] 目录说明（当前会话版本）
├── Session-N到Session-N+1交接文档.md   [必须] 当前交接文档
└── PRD-初稿.md                         [必须] 产品需求文档（长期保留）
```

**文件数量**: 通常 3 个文件

**禁止内容**：
- ? 历史会话的规划文档
- ? 已完成会话的交接文档
- ? 执行清单、执行规划等详细文档

### 会话记录目录（01-会话记录/Session-N）

**必须包含**：
```
Doc/01-会话记录/Session-N/
├── README.md                           [必须] 会话文档索引
├── Session-N完成总结.md                [必须] 会话总结
├── Session-N执行完成报告.md            [必须] 执行报告
├── 功能实现报告.md                     [可选] 功能详细报告
├── Bug修复报告.md                      [可选] Bug修复记录
│
├── 规划文档（归档）
│   ├── README-Session-N规划索引.md     [必须] 规划索引
│   ├── Session-N-1到Session-N交接文档.md [必须] 交接文档
│   ├── Session-N-执行规划.md           [推荐] 详细规划
│   └── Session-N-执行清单.md           [推荐] 任务清单
│
└── 归档文档
    ├── Session-N归档完成报告.md        [必须] 归档报告
    └── Session-N规划文档归档完成报告.md [必须] 规划归档报告
```

---

## ?? 归档流程规范

### 阶段 1：会话完成验证（会话结束时）

#### 1.1 功能完成检查
- [ ] 所有计划功能 100% 完成
- [ ] 编译成功（0错误0警告）
- [ ] 功能测试通过
- [ ] 代码质量达标

#### 1.2 文档完整检查
- [ ] 会话总结已创建
- [ ] 执行报告已创建
- [ ] 功能文档已创建
- [ ] 代码注释完整

#### 1.3 下一会话准备
- [ ] 下一会话目标明确
- [ ] 技术方案可行
- [ ] 时间估算合理

---

### 阶段 2：会话记录归档（立即执行）

#### 2.1 子目录合并（如果存在）
**检查条件**：
```
是否存在子目录？
- Session-N-Part1/
- Session-N-Part2/
- 其他子目录
```

**执行操作**：
```powershell
# 移动文件到主目录
Move-Item "Session-N-PartX/*.md" "Session-N/"

# 删除子目录
Remove-Item "Session-N-PartX" -Recurse
```

**创建报告**：
- 创建 `Session-N归档完成报告.md`
- 记录合并的文件清单
- 说明合并原因

#### 2.2 更新会话 README
**必须更新**：
- [ ] 更新文档索引
- [ ] 添加新增文档链接
- [ ] 更新统计数据
- [ ] 添加归档说明

**模板参考**：
```markdown
### ?? 文档结构

### 归档文档
#### N. [Session-N归档完成报告.md] ???
**归档报告** - 归档过程和结果
```

---

### 阶段 3：规划文档归档（紧接执行）

#### 3.1 识别需归档文件
**必须归档**：
```
06-规划文档/
├── README-Session-N规划索引.md         [移动]
├── Session-N-1到Session-N交接文档.md   [移动]
├── Session-N-执行规划.md               [移动]
└── Session-N-执行清单.md               [移动]
```

#### 3.2 执行归档操作
```powershell
# 移动规划文档到会话记录
Move-Item "06-规划文档/README-Session-N规划索引.md" `
          "01-会话记录/Session-N/"

Move-Item "06-规划文档/Session-N-1到Session-N交接文档.md" `
          "01-会话记录/Session-N/"

Move-Item "06-规划文档/Session-N-执行规划.md" `
          "01-会话记录/Session-N/"

Move-Item "06-规划文档/Session-N-执行清单.md" `
          "01-会话记录/Session-N/"
```

#### 3.3 更新规划目录说明
**文件**: `06-规划文档/README-规划文档说明.md`

**必须更新**：
- [ ] 更新当前规划为 Session-N+1
- [ ] 更新当前目录结构
- [ ] 添加 Session-N 归档记录
- [ ] 更新归档历史表格

**模板参考**：
```markdown
> **更新日期**: YYYY-MM-DD  
> **当前规划**: Session-N+1

### Session-N 规划文档（已归档）?
**归档位置**: `Doc/01-会话记录/Session-N/`
**归档日期**: YYYY-MM-DD

## ?? 归档历史

| 会话 | 归档日期 | 归档文件数 | 归档位置 |
|------|---------|-----------|---------|
| Session-N | YYYY-MM-DD | 4个 | `01-会话记录/Session-N/` |
```

#### 3.4 更新会话 README
**添加规划文档索引**：
```markdown
### ?? 规划文档（已归档）

#### N. [README-Session-N规划索引.md] ????
**规划索引** - Session-N规划文档导航

#### N+1. [Session-N-1到Session-N交接文档.md] ????
**交接文档** - Session-N-1到Session-N的交接
```

#### 3.5 创建归档报告
**文件**: `Session-N规划文档归档完成报告.md`

**必须包含**：
- 归档概述
- 归档前后对比
- 文件清单
- 质量验证
- 归档统计

---

### 阶段 4：交接文档创建（最后执行）

#### 4.1 PRD 完成情况分析
**分析内容**：
- [ ] P0 功能完成情况
- [ ] P1 功能完成情况
- [ ] P2/P3 功能状态
- [ ] 整体进度百分比

**输出格式**：
```markdown
### P0 功能（必须实现）
完成度:  100% (X/Y)

### P1 功能（优先实现）
完成度: ??????????????  XX% (X/Y)
```

#### 4.2 下一会话规划
**必须包含**：
- [ ] Session-N 成果总结
- [ ] Session-N+1 目标设定
- [ ] 推荐开发方案（3个）
- [ ] 技术栈准备
- [ ] 必读文档清单
- [ ] 时间估算
- [ ] 风险评估

#### 4.3 创建交接文档
**文件**: `06-规划文档/Session-N到Session-N+1交接文档.md`

**文档结构**：
```markdown
# ?? Session-N → Session-N+1 交接文档

## ?? Session-N 完成情况
- 已完成功能
- 重要成果

## ?? 项目当前状态
- 功能完成度
- P0/P1/P2 进度

## ?? Session-N+1 任务规划
- 核心目标
- 优先级排序
- 推荐方案（A/B/C）

## ?? 必读文档
- 优先级分级
- 阅读时间

## ?? 技术准备
- 技术栈
- 开发环境

## ?? 开发模式选择
- 方案对比
- 推荐理由

## ?? 风险评估
- 技术风险
- 时间风险

## ?? 建议和提示
- 开发建议
- 技术建议
```

---

### 阶段 5：项目文档更新（同步执行）

#### 5.1 更新项目状态总览
**文件**: `00-必读/项目状态总览.md`

**必须更新**：
- [ ] 更新当前版本号
- [ ] 更新功能完成度统计
- [ ] 更新 P0/P1/P2 进度
- [ ] 添加 Session-N 成果
- [ ] 更新已完成功能清单
- [ ] 更新文档统计数据
- [ ] 更新里程碑进度

**更新示例**：
```markdown
### P0 核心功能（必须完成）?
| 功能 | 状态 | 完成会话 |
|------|------|----------|
| 新功能 | ? 完成 | Session-N |

### 已完成的核心功能
### N. 新功能（Session-N）?
- ? 功能点1
- ? 功能点2

### 会话统计
- **会话次数**: N 次
- **新增功能**: X+ 个
```

#### 5.2 创建最终总结报告
**文件**: `Session-N归档与Session-N+1准备完成总结.md`

**必须包含**：
- 归档工作总结
- PRD 完成情况
- Session-N+1 准备
- 质量验证
- 统计数据

---

## ? 归档完成验证清单

### 文件完整性检查
- [ ] 会话记录文档齐全（README + 总结 + 报告）
- [ ] 规划文档已归档（4个文件）
- [ ] 归档报告已创建（2个文件）
- [ ] 交接文档已创建
- [ ] 项目文档已更新

### 目录结构检查
- [ ] 06-规划文档仅3个文件（README + 交接 + PRD）
- [ ] Session-N 目录文档完整（10+个文件）
- [ ] 文档分类清晰
- [ ] 命名规范统一

### 文档质量检查
- [ ] 所有 README 已更新
- [ ] 所有链接有效
- [ ] 格式规范统一
- [ ] 内容完整准确

### 编译验证
- [ ] 代码编译成功
- [ ] 0 错误 0 警告
- [ ] 功能正常运行

---

## ?? 归档工作时间估算

| 阶段 | 工作内容 | 预计时间 |
|------|---------|---------|
| 阶段1 | 会话完成验证 | 10分钟 |
| 阶段2 | 会话记录归档 | 15分钟 |
| 阶段3 | 规划文档归档 | 20分钟 |
| 阶段4 | 交接文档创建 | 30分钟 |
| 阶段5 | 项目文档更新 | 15分钟 |
| **总计** | **完整归档流程** | **90分钟** |

---

## ?? 最佳实践

### DO - 应该做的
1. ? **立即归档** - 会话完成后立即执行
2. ? **完整记录** - 创建详细的归档报告
3. ? **质量验证** - 归档后全面检查
4. ? **及时更新** - 同步更新相关文档
5. ? **保持简洁** - 规划目录只保留当前

### DON'T - 不应该做的
1. ? **延迟归档** - 不要拖到下一会话
2. ? **遗漏文件** - 不要遗漏规划文档
3. ? **跳过验证** - 不要跳过质量检查
4. ? **文档堆积** - 不要在规划目录堆积历史文档
5. ? **链接失效** - 不要留下死链接

---

## ?? 文档命名规范

### 会话记录文档
```
Session-N完成总结.md                    [标准格式]
Session-N执行完成报告.md                [标准格式]
Session-N归档完成报告.md                [标准格式]
Session-N规划文档归档完成报告.md        [标准格式]
Session-N归档与Session-N+1准备完成总结.md [标准格式]
```

### 规划文档
```
README-Session-N规划索引.md             [标准格式]
Session-N-1到Session-N交接文档.md       [标准格式]
Session-N-执行规划.md                   [标准格式]
Session-N-执行清单.md                   [标准格式]
```

### 交接文档
```
Session-N到Session-N+1交接文档.md       [标准格式]
```

---

## ?? 相关规范

### 必读文档
- [文档编写规范](文档编写规范.md) - 基础规范
- [项目状态总览](项目状态总览.md) - 项目状态
- [快速上手指南](快速上手指南.md) - 新手指南

### 参考示例
- [Session-06归档示例](../01-会话记录/Session-06/) - 完整归档示例
- [Session-06规划文档归档报告](../01-会话记录/Session-06/Session-06规划文档归档完成报告.md) - 归档报告示例

---

## ?? 常见问题

### Q1: 什么时候触发归档？
**A**: 会话 100% 完成、下一会话规划就绪、交接文档已创建时立即归档。

### Q2: 规划文档必须全部归档吗？
**A**: 是的。除了当前会话的交接文档和 PRD，其他所有规划文档都必须归档。

### Q3: 归档报告必须创建吗？
**A**: 是的。必须创建详细的归档报告，记录归档过程和结果。

### Q4: 子目录必须合并吗？
**A**: 是的。避免目录结构过深，所有子目录的文档应合并到主会话目录。

### Q5: 如何验证归档完成？
**A**: 使用归档完成验证清单，逐项检查文件完整性、目录结构、文档质量。

### Q6: 交接文档应该包含哪些内容？
**A**: Session-N 成果、项目状态、Session-N+1 规划、推荐方案、技术准备、必读文档。

### Q7: 项目文档需要同步更新吗？
**A**: 是的。必须同步更新项目状态总览，添加新功能和更新进度。

### Q8: 归档工作需要多长时间？
**A**: 完整的归档流程预计 60-90 分钟，包括所有阶段的工作。

---

## ?? 归档成功标准

### 完成标志
- ? 所有文件完整归档
- ? 规划目录仅3个文件
- ? 会话目录文档完整
- ? 交接文档创建完成
- ? 项目文档已更新
- ? 编译测试通过
- ? 质量检查通过

### 质量标准
- ? 文档完整度: 100%
- ? 链接有效性: 100%
- ? 格式规范性: 优秀
- ? 易用性: 显著提升

---

## ?? 持续改进

### 反馈机制
如果发现归档流程有问题或可以改进的地方，请：
1. 记录问题描述
2. 提出改进建议
3. 更新本规范文档
4. 通知相关人员

### 版本历史
| 版本 | 日期 | 变更内容 | 变更人 |
|------|------|---------|--------|
| 1.0 | 2025-01-02 | 初始版本 | AI Agent |

---

**文档版本**: 1.0  
**创建日期**: 2025-01-02  
**最后更新**: 2025-01-02  
**维护者**: SceneTodo Team  
**状态**: ? 正式发布

---

**?? 严格遵守本规范，确保项目文档体系的完整性和可维护性！**

**?? 每个会话完成后必须执行完整的归档流程！**

**?? 及时归档，保持文档清晰，为下一会话做好准备！**
