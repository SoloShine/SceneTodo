# ?? SceneTodo 项目状态总览

> **创建日期**: 2026-01-02 18:40:14  
> **最后更新**: 2026-01-02 18:40:14  
> **版本**: 1.0  
> **状态**: 正式发布

---

## ?? 文档说明

本文档提供 SceneTodo 项目的当前状态快照，包括功能完成度、技术架构、已知问题等关键信息。

**适用读者**: 所有项目参与者（开发、测试、产品、用户）

---

## ?? 项目基本信息

### 项目概述
**SceneTodo** (原名 TodoOverlayApp) 是一个实用的桌面待办事项悬浮窗应用，可关联特定软件窗口并显示相关待办事项。

### 核心价值
帮助用户在使用特定软件时快速查看和管理相关的待办事项，解决传统待办软件与工作流程脱节的问题。

### 技术栈
- **框架**: .NET 8 + WPF
- **UI库**: HandyControl
- **数据库**: SQLite + Entity Framework Core
- **图标**: MahApps.Metro.IconPacks

### 项目信息
- **当前版本**: v1.2.0
- **开发阶段**: Alpha（核心功能开发中）
- **目标平台**: Windows 10/11
- **开源地址**: https://github.com/SoloShine/SceneTodo

---

## ?? 功能完成度统计

### P0 核心功能（必须完成）

| 功能 | 状态 | 完成度 | 说明 |
|------|------|--------|------|
| 1. 优先级管理 | ? 已完成 | 100% | 高/中/低三个级别，颜色标识 |
| 2. 关联操作 | ? 已完成 | 100% | 支持关联网页、文件、应用 |
| 3. 历史记录 | ? 已完成 | 100% | 查看、恢复、删除历史记录 |
| 4. 遮盖层位置选择 | ? 未开始 | 0% | 待开发 |

**P0 完成度**: 75% (3/4)

### P1 重要功能（建议完成）

| 功能 | 状态 | 完成度 | 说明 |
|------|------|--------|------|
| 1. 折叠/展开 | ? 未开始 | 0% | 树形结构的折叠展开 |
| 2. 数据备份恢复 | ? 未开始 | 0% | 导入导出功能 |
| 3. 分类标签管理 | ? 未开始 | 0% | 自定义标签和分类 |
| 4. 一对多挂载 | ? 未开始 | 0% | 一个软件挂载多个位置 |

**P1 完成度**: 0% (0/4)

### P2 增强功能（可选完成）

| 功能 | 状态 | 完成度 | 说明 |
|------|------|--------|------|
| 1. 账号系统 | ? 未开始 | 0% | 多设备同步 |
| 2. 桌面小部件 | ? 未开始 | 0% | 独立的桌面小工具 |
| 3. 系统服务 | ? 未开始 | 0% | 后台服务运行 |
| 4. HTTP API | ? 未开始 | 0% | 供其他应用调用 |

**P2 完成度**: 0% (0/4)

### 整体进度
**总体完成度**: 约 30-35%

---

## ? 已完成的核心功能

### 1. 基础功能（v1.0）
- ? 创建和管理待办事项
- ? 软件窗口关联
- ? 悬浮窗自动跟随
- ? 父子待办项层级结构
- ? 待办项的勾选/取消
- ? 数据库持久化（SQLite）
- ? 自动注入目标窗口
- ? 托盘图标和菜单

### 2. 优先级功能（Session-01）
- ? 三个优先级：高/中/低
- ? 颜色标识：红/黄/绿
- ? 优先级排序
- ? 优先级编辑
- ? 数据库存储

**实现文件**:
- `Converters/PriorityToBorderBrushConverter.cs`
- `Models/TodoItemModel.cs`
- `Views/EditTodoItemWindow.xaml`
- `Views/TodoItemControl.xaml`

### 3. 关联操作功能（Session-01）
- ? 关联网页（HTTP/HTTPS）
- ? 关联本地文件（任意格式）
- ? 关联应用程序（.exe）
- ? 一键执行关联操作
- ? 关联操作编辑和删除

**实现文件**:
- `Models/LinkedAction.cs`
- `Views/EditLinkedActionWindow.xaml/.cs`
- `Views/TodoItemControl.xaml`

### 4. 历史记录功能（Session-01）
- ? 记录所有待办项变更
- ? 按时间倒序显示
- ? 恢复历史版本
- ? 删除历史记录
- ? 数据库自动清理

**实现文件**:
- `ViewModels/HistoryWindowViewModel.cs`
- `Views/HistoryWindow.xaml/.cs`
- `Services/Database/Repositories/TodoItemRepository.cs`

### 5. UI优化（Session-02）
- ? 主页显示优化
- ? 应用绑定继承（子项自动继承父项软件绑定）
- ? 编辑窗口改进
- ? 布局优化

### 6. 右键菜单交互（Session-03）
- ? 右键菜单替代悬停按钮
- ? 所有操作集成到右键菜单
- ? 注入状态可视化标签
- ? 快捷键支持（Alt+E/A/L/I/D）
- ? 修复操作按钮悬停消失问题

**实现文件**:
- `Converters/InjectedToTextConverter.cs`
- `Converters/InjectedToColorConverter.cs`
- `Views/TodoItemControl.xaml`

---

## ?? 进行中的工作

目前无正在进行的开发工作。

---

## ?? 待开发功能

### 近期优先（P0剩余）
1. **遮盖层位置选择** ?????
   - 支持多个位置：左上、右上、左下、右下、左侧、底部等
   - 支持偏移量设置
   - 预计工作量：3-4小时
   - 参考文档：`Doc/01-会话记录/Session-01-P0核心功能实现/P0核心功能实现指南.md`

### 中期计划（P1功能）
2. **折叠/展开功能** (2-3小时)
   - 树形结构的折叠展开
   - 记忆折叠状态

3. **数据备份与恢复** (4-5小时)
   - 导出为JSON文件
   - 从JSON导入

4. **分类标签管理** (3-4小时)
   - 自定义标签
   - 标签筛选

5. **一对多挂载** (4-5小时)
   - 一个软件挂载多个位置
   - 多个悬浮窗同时显示

### 长期规划（P2功能）
6. **账号系统** (10+小时，复杂）
7. **桌面小部件** (6-8小时)
8. **系统服务** (8-10小时)
9. **HTTP API** (10+小时)

---

## ?? 已知问题

### P0 级别（阻断性）
目前无P0级别问题。

### P1 级别（重要）
1. **历史记录窗口未集成到主界面**
   - MainWindow.xaml 中缺少"历史记录"菜单按钮
   - ShowHistoryCommand 已实现，但UI未添加入口
   - **影响**: 用户无法打开历史记录窗口
   - **修复方案**: 在主窗口添加按钮
   - **预计工作量**: 10分钟

### P2 级别（优化）
1. **历史记录分页未实现**
   - 大量历史记录时可能影响性能
   - **建议**: 实现分页加载
   - **预计工作量**: 2-3小时

2. **部分代码需要重构**
   - MainWindowViewModel.cs 有重复的if判断
   - 部分命名不一致
   - **建议**: 后续统一重构

---

## ?? 数据库架构

### 数据表
1. **TodoItems** - 待办事项主表
   - 基本字段：Id, Title, Content, IsCompleted, CreatedAt
   - 层级字段：ParentId（支持树形结构）
   - 关联字段：AppPath, AppName（软件关联）
   - 优先级字段：Priority（0=低, 1=中, 2=高）
   - 关联操作：LinkedActionsJson（JSON存储）

2. **TodoItemHistories** - 历史记录表
   - 字段：Id, TodoItemId, ContentJson, CreatedAt
   - 存储待办项的历史快照

3. **AutoTasks** - 自动任务表（前置准备）
   - 用于未来的自动化功能
   - 使用Quartz实现

### 数据库位置
- **路径**: `%LocalAppData%\SceneTodo\todo.db`
- **类型**: SQLite
- **ORM**: Entity Framework Core
- **迁移方式**: EnsureCreated（自动）

---

## ??? 技术架构

### 架构模式
- **MVVM**: 严格分离视图和逻辑
- **Command模式**: ICommand连接UI操作
- **Repository模式**: 数据访问层抽象

### 关键组件

#### 1. Models（数据模型）
- `TodoItem.cs` - 待办项数据库模型
- `TodoItemModel.cs` - 待办项业务模型
- `LinkedAction.cs` - 关联操作模型
- `MainWindowModel.cs` - 主窗口配置模型

#### 2. ViewModels（视图模型）
- `MainWindowViewModel.cs` - 主窗口逻辑（最复杂）
- `HistoryWindowViewModel.cs` - 历史记录窗口逻辑

#### 3. Views（视图）
- `MainWindow.xaml` - 主窗口
- `OverlayWindow.xaml` - 悬浮窗
- `EditTodoItemWindow.xaml` - 编辑窗口
- `EditLinkedActionWindow.xaml` - 关联操作编辑窗口
- `HistoryWindow.xaml` - 历史记录窗口
- `TodoItemControl.xaml` - 待办项控件（核心）
- `TodoTreeView.xaml` - 树形视图控件

#### 4. Converters（值转换器）
- `PriorityToBorderBrushConverter.cs` - 优先级颜色转换
- `InjectedToTextConverter.cs` - 注入状态文本转换
- `InjectedToColorConverter.cs` - 注入状态颜色转换
- `EnumToDescriptionConverter.cs` - 枚举描述转换
- 其他工具转换器...

#### 5. Services（服务层）
- **Database**: 数据库服务
  - `TodoDbContext.cs` - EF Core上下文
  - `DatabaseInitializer.cs` - 数据库初始化
  - `DbContextFactory.cs` - 数据库上下文工厂
  - `TodoItemRepository.cs` - 待办项仓储
  - `AutoTaskRepository.cs` - 自动任务仓储
- **Scheduler**: 调度服务
  - `TodoItemSchedulerService.cs` - Quartz调度服务

#### 6. Utils（工具类）
- `IconHelper.cs` - 图标提取工具
- `TrayIconManager.cs` - 托盘图标管理
- `NativeMethods.cs` - Win32 API封装
- `ColorPickerHelper.cs` - 颜色选择辅助

### 项目文件
- **主项目**: `SceneTodo.csproj`
- **解决方案**: `TodoOverlayApp.sln`
- **配置文件**: `app_associations.json`

---

## ?? 开发环境

### 必需工具
- **Visual Studio 2022+** 或 **Visual Studio Code**
- **.NET 8 SDK**
- **SQLite 浏览器**（可选，用于查看数据库）

### NuGet 包
- `HandyControl` - UI控件库
- `Microsoft.EntityFrameworkCore.Sqlite` - SQLite支持
- `MahApps.Metro.IconPacks` - 图标库
- `Newtonsoft.Json` - JSON序列化
- `Quartz` - 任务调度（前置准备）

### 构建配置
- **目标框架**: .NET 8
- **C# 版本**: 12.0
- **应用类型**: WPF应用程序
- **输出类型**: Windows应用程序（无控制台）

---

## ?? 文档体系

### 00-必读
- `README.md` - 文档中心入口
- `项目状态总览.md` - 本文档
- `快速上手指南.md` - 5分钟上手
- `交接文档-最新版.md` - 完整交接文档
- `文档编写规范.md` - 文档编写标准
- `文档时间规范添加完成报告.md` - 时间规范说明

### 01-会话记录
- `Session-01-P0核心功能实现/` - 第一次会话记录
- `Session-02-UI优化/` - UI优化会话
- `Session-03-右键菜单改进/` - 最新会话记录

### 其他目录
- `02-功能文档/` - 功能详细说明
- `03-测试文档/` - 测试计划和用例
- `04-技术文档/` - 技术实现细节
- `05-用户文档/` - 用户使用手册
- `06-规划文档/` - 产品规划和路线图

---

## ?? 学习路径

### 新手开发者（第一天）
1. 阅读本文档 - 15分钟
2. 阅读快速上手指南 - 15分钟
3. 运行应用，体验功能 - 30分钟
4. 查看代码结构 - 30分钟

### 进阶开发者（第一周）
1. 阅读完整交接文档 - 1小时
2. 阅读会话记录（最近3次） - 2小时
3. 深入理解核心代码 - 4小时
4. 开始修复小问题或优化 - 持续

### 高级开发者（持续）
1. 架构设计和重构
2. 性能优化
3. 新功能开发
4. 代码审查和改进

---

## ?? 相关链接

### 项目资源
- **GitHub仓库**: https://github.com/SoloShine/SceneTodo
- **本地路径**: D:\Documents\GitHub\SceneTodo\

### 技术文档
- **.NET 8文档**: https://learn.microsoft.com/zh-cn/dotnet/
- **WPF文档**: https://learn.microsoft.com/zh-cn/dotnet/desktop/wpf/
- **HandyControl**: https://handyorg.github.io/
- **Entity Framework Core**: https://learn.microsoft.com/zh-cn/ef/core/

### 开源组件
- **MahApps.Metro.IconPacks**: https://github.com/MahApps/MahApps.Metro.IconPacks/
- **Quartz.NET**: https://www.quartz-scheduler.net/

---

## ?? 获取帮助

### 常见问题
查看 `Doc/05-用户文档/常见问题.md`（待创建）

### 报告Bug
- GitHub Issues: 报告Bug和功能请求
- 提供详细的复现步骤和截图

### 贡献代码
1. Fork项目
2. 创建功能分支
3. 提交Pull Request
4. 遵循代码规范和文档规范

---

## ?? 项目统计（估算）

### 代码统计
- **总代码行数**: 约 15,000+ 行
- **C# 代码**: 约 10,000 行
- **XAML 代码**: 约 5,000 行
- **文件数量**: 约 50+ 个代码文件

### 开发统计
- **开发时长**: 约 30+ 小时
- **会话次数**: 3 次
- **新增功能**: 10+ 个
- **修复Bug**: 5+ 个

### 文档统计
- **文档数量**: 20+ 个
- **文档行数**: 约 8,000+ 行
- **测试文档**: 5+ 个
- **会话记录**: 3 个

---

## ?? 开发建议

### 对新开发者
1. **先测试，再开发**: 运行应用，熟悉功能
2. **阅读会话记录**: 了解历史决策
3. **遵循规范**: 代码规范和文档规范
4. **小步提交**: 每次提交一个小功能
5. **完善文档**: 每次修改都要更新文档

### 对产品经理
1. **功能优先级**: 先完成P0，再做P1
2. **用户反馈**: 及时收集用户反馈
3. **迭代开发**: 快速迭代，持续改进

### 对测试人员
1. **参考测试文档**: 查看各会话的测试指南
2. **记录问题**: 详细记录复现步骤
3. **回归测试**: 新功能要做回归测试

---

## ?? 里程碑

### v1.0 - P0核心功能（3/4完成）
- ? 优先级功能
- ? 关联操作功能
- ? 历史记录功能
- ? 遮盖层位置选择（待开发）

### v2.0 - P1重要功能（规划中）
- ? 折叠/展开功能
- ? 数据备份与恢复
- ? 分类标签管理
- ? 一对多挂载

### v3.0 - P2增强功能（远期规划）
- ? 账号系统
- ? 桌面小部件
- ? 系统服务
- ? HTTP API

---

## ? 快速参考

### 启动应用
```bash
# 开发模式
dotnet run

# 发布版本
dotnet publish -c Release
```

### 数据库位置
```
%LocalAppData%\SceneTodo\todo.db
```

### 配置文件
```
%LocalAppData%\SceneTodo\app_associations.json
```

### 日志文件
```
%LocalAppData%\SceneTodo\logs\
```

---

## ?? 更新历史

| 日期 | 版本 | 变更内容 | 变更人 |
|------|------|----------|--------|
| 2026-01-02 18:40:14 | 1.0 | 初始版本，重建文档 | AI Agent |

---

**文档版本**: 1.0  
**创建日期**: 2026-01-02 18:40:14  
**最后更新**: 2026-01-02 18:40:14  
**维护者**: SceneTodo Team

**欢迎来到 SceneTodo 项目！** ??
